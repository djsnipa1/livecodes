{"version":3,"file":"index.js","sources":["../../src/livecodes/services/allowed-origin.ts","../../src/livecodes/services/share.ts","../../src/livecodes/html/app.html?raw","../../src/livecodes/events/custom-events.ts","../../src/livecodes/utils/utils.ts","../../src/livecodes/services/modules.ts","../../src/livecodes/vendors.ts","../../src/livecodes/main.ts","../../src/index.ts"],"sourcesContent":["export const allowedOrigin = (origin = location.origin) =>\n  Boolean(\n    origin &&\n      (origin.endsWith('livecodes.io') ||\n        origin.endsWith('livecodes.pages.dev') ||\n        origin.endsWith('localpen.io') ||\n        origin.endsWith('localpen.pages.dev') ||\n        origin.startsWith('http://127.0.0.1') ||\n        origin.startsWith('http://localhost')),\n  );\n\nexport const whitelistTarget = (url: string) =>\n  new RegExp(/^(?:(?:http|https):\\/\\/(?:\\w+.)?)(githubusercontent.com|jsbin.com|)\\/(?:.*)/g).test(\n    url,\n  );\n","import type { Config } from '../models';\r\nimport { allowedOrigin } from './allowed-origin';\r\n\r\nconst dpasteGetUrl = 'https://dpaste.com/';\r\nconst dpastePostUrl = 'https://dpaste.com/api/v2/';\r\nconst apiUrl = 'https://api2.livecodes.io/share';\r\n\r\ntype ConfigWithResult = Partial<Config & { result: string }>;\r\ninterface ShareService {\r\n  getProject: (id: string) => Promise<ConfigWithResult>;\r\n  shareProject: (config: ConfigWithResult) => Promise<string>;\r\n}\r\n\r\nconst dpasteService = {\r\n  getProject: async (id: string): Promise<ConfigWithResult> => {\r\n    try {\r\n      const res = await fetch(dpasteGetUrl + id + '.txt');\r\n      if (!res.ok) return {};\r\n      return JSON.parse(await res.text());\r\n    } catch (error) {\r\n      return {};\r\n    }\r\n  },\r\n  shareProject: async (config: ConfigWithResult): Promise<string> => {\r\n    try {\r\n      const res = await fetch(dpastePostUrl, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Content-Type': 'application/x-www-form-urlencoded',\r\n          'User-Agent': 'LiveCodes / https://livecodes.io/',\r\n        },\r\n        body: `content=${encodeURIComponent(JSON.stringify(config))}&title=${encodeURIComponent(\r\n          config.title || '',\r\n        )}&syntax=json&expiry_days=365`,\r\n      });\r\n      if (!res.ok) return '';\r\n      const url = await res.text();\r\n      return url.replace(dpasteGetUrl, '');\r\n    } catch (error) {\r\n      return '';\r\n    }\r\n  },\r\n};\r\n\r\nconst apiService = {\r\n  getProject: async (id: string): Promise<ConfigWithResult> => {\r\n    // for backward compatibility\r\n    if (id.length < 11) return dpasteService.getProject(id);\r\n\r\n    if (!allowedOrigin()) return {};\r\n    try {\r\n      const res = await fetch(apiUrl + '?id=' + id);\r\n      if (!res.ok) return {};\r\n      return JSON.parse(await res.text());\r\n    } catch (error) {\r\n      return {};\r\n    }\r\n  },\r\n  shareProject: async (config: ConfigWithResult): Promise<string> => {\r\n    if (!allowedOrigin()) return '';\r\n    try {\r\n      const res = await fetch(apiUrl, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        body: JSON.stringify(config),\r\n      });\r\n      if (!res.ok) return '';\r\n      return res.text();\r\n    } catch (error) {\r\n      return '';\r\n    }\r\n  },\r\n};\r\n\r\nexport const shareService: ShareService = allowedOrigin() ? apiService : dpasteService;\r\n","export default \"<!DOCTYPE html>\\r\\n<html lang=\\\"en\\\">\\r\\n  <head>\\r\\n    <meta charset=\\\"UTF-8\\\" />\\r\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\" />\\r\\n    <title>LiveCodes</title>\\r\\n    <style>\\r\\n      body {\\r\\n        overflow: hidden;\\r\\n      }\\r\\n    </style>\\r\\n    <link rel=\\\"preconnect\\\" href=\\\"https://cdn.jsdelivr.net\\\" crossorigin />\\r\\n    <link rel=\\\"dns-prefetch\\\" href=\\\"https://cdn.jsdelivr.net\\\" />\\r\\n    <link rel=\\\"stylesheet\\\" href=\\\"{{baseUrl}}{{hash:app.css}}\\\" id=\\\"app-styles\\\" />\\r\\n    <script src=\\\"{{esModuleShimsUrl}}\\\" async></script>\\r\\n    <script type=\\\"importmap\\\">\\r\\n      {\\r\\n        \\\"imports\\\": {\\r\\n          \\\"@codemirror/autocomplete\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/commands\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/language\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/lint\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/search\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/state\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/theme-one-dark\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/view\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/lang-html\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/lang-css\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@codemirror/lang-javascript\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@lezer/common\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@lezer/highlight\\\": \\\"{{codemirrorCoreUrl}}\\\",\\r\\n          \\\"@lezer/lr\\\": \\\"{{codemirrorCoreUrl}}\\\"\\r\\n        }\\r\\n      }\\r\\n    </script>\\r\\n  </head>\\r\\n  <body>\\r\\n    <div id=\\\"container\\\">\\r\\n      <div id=\\\"toolbar\\\">\\r\\n        <div id=\\\"logo\\\">\\r\\n          <a href=\\\"/\\\" title=\\\"LiveCodes: Code playground that runs in the browser!\\\"\\r\\n            ><img\\r\\n              alt=\\\"LiveCodes Logo\\\"\\r\\n              src=\\\"{{baseUrl}}assets/images/livecodes-logo.svg\\\"\\r\\n              width=\\\"50\\\"\\r\\n              loading=\\\"lazy\\\"\\r\\n          /></a>\\r\\n        </div>\\r\\n        <div id=\\\"select-editor\\\"></div>\\r\\n        <div id=\\\"project-title\\\" contenteditable=\\\"true\\\" tabindex=\\\"8\\\">Untitled Project</div>\\r\\n        <div id=\\\"buttons\\\">\\r\\n          <a\\r\\n            href=\\\"javascript:void(0)\\\"\\r\\n            id=\\\"run-button\\\"\\r\\n            class=\\\"button hint--bottom\\\"\\r\\n            data-hint=\\\"Run (Shift + Enter)\\\"\\r\\n            tabindex=\\\"9\\\"\\r\\n          >\\r\\n            <img\\r\\n              width=\\\"20\\\"\\r\\n              height=\\\"20\\\"\\r\\n              alt=\\\"Run\\\"\\r\\n              src=\\\"{{baseUrl}}assets/images/play.svg\\\"\\r\\n              loading=\\\"lazy\\\"\\r\\n            />\\r\\n          </a>\\r\\n          <a\\r\\n            href=\\\"javascript:void(0)\\\"\\r\\n            id=\\\"result-button\\\"\\r\\n            class=\\\"button hint--bottom\\\"\\r\\n            data-hint=\\\"Toggle Result\\\"\\r\\n            tabindex=\\\"10\\\"\\r\\n          >\\r\\n            <img\\r\\n              width=\\\"28\\\"\\r\\n              height=\\\"28\\\"\\r\\n              alt=\\\"Result\\\"\\r\\n              src=\\\"{{baseUrl}}assets/images/document.svg\\\"\\r\\n              loading=\\\"lazy\\\"\\r\\n            />\\r\\n          </a>\\r\\n          <a\\r\\n            href=\\\"javascript:void(0)\\\"\\r\\n            id=\\\"fullscreen-button\\\"\\r\\n            class=\\\"button hint--bottom\\\"\\r\\n            data-hint=\\\"Full Screen\\\"\\r\\n            tabindex=\\\"11\\\"\\r\\n          >\\r\\n            <img\\r\\n              width=\\\"28\\\"\\r\\n              height=\\\"28\\\"\\r\\n              alt=\\\"Fullscreen\\\"\\r\\n              src=\\\"{{baseUrl}}assets/images/expand.svg\\\"\\r\\n              loading=\\\"lazy\\\"\\r\\n            />\\r\\n          </a>\\r\\n          <a\\r\\n            href=\\\"javascript:void(0)\\\"\\r\\n            id=\\\"settings-button\\\"\\r\\n            class=\\\"button\\\"\\r\\n            aria-label=\\\"Menu\\\"\\r\\n            tabindex=\\\"12\\\"\\r\\n          >\\r\\n            <img\\r\\n              width=\\\"30\\\"\\r\\n              height=\\\"30\\\"\\r\\n              alt=\\\"Menu\\\"\\r\\n              src=\\\"{{baseUrl}}assets/images/menu.svg\\\"\\r\\n              loading=\\\"lazy\\\"\\r\\n            />\\r\\n          </a>\\r\\n          <div id=\\\"settings-menu-container\\\" class=\\\"menu-scroller\\\"></div>\\r\\n        </div>\\r\\n      </div>\\r\\n      <div id=\\\"editor-container\\\">\\r\\n        <div id=\\\"editors\\\">\\r\\n          <div id=\\\"markup\\\" class=\\\"editor\\\"></div>\\r\\n          <div id=\\\"style\\\" class=\\\"editor\\\"></div>\\r\\n          <div id=\\\"script\\\" class=\\\"editor\\\"></div>\\r\\n\\r\\n          <div id=\\\"editor-tools\\\" class=\\\"tool-buttons\\\">\\r\\n            <span\\r\\n              id=\\\"copy-btn\\\"\\r\\n              class=\\\"hint--top-right\\\"\\r\\n              data-hint=\\\"Copy (Ctrl/Cmd + A, Ctrl/Cmd + C)\\\"\\r\\n            >\\r\\n              <img src=\\\"{{baseUrl}}assets/images/copy.svg\\\" alt=\\\"copy\\\" />\\r\\n            </span>\\r\\n            <span id=\\\"undo-btn\\\" class=\\\"hint--top-right\\\" data-hint=\\\"Undo (Ctrl/Cmd + Z)\\\">\\r\\n              <img src=\\\"{{baseUrl}}assets/images/undo.svg\\\" alt=\\\"undo\\\" />\\r\\n            </span>\\r\\n            <span id=\\\"redo-btn\\\" class=\\\"hint--top-right\\\" data-hint=\\\"Redo (Ctrl/Cmd + Shift + Z)\\\">\\r\\n              <img src=\\\"{{baseUrl}}assets/images/redo.svg\\\" alt=\\\"redo\\\" />\\r\\n            </span>\\r\\n            <span id=\\\"format-btn\\\" class=\\\"hint--top-right\\\" data-hint=\\\"Format (Alt + Shift + F)\\\">\\r\\n              <img src=\\\"{{baseUrl}}assets/images/format.svg\\\" alt=\\\"format\\\" />\\r\\n            </span>\\r\\n            <span id=\\\"editor-status\\\">\\r\\n              <span id=\\\"editor-mode\\\" class=\\\"hint--top-right\\\" data-hint=\\\"Editor Mode\\\"></span>\\r\\n              <span data-status=\\\"markup\\\"></span>\\r\\n              <span data-status=\\\"style\\\"></span>\\r\\n              <span data-status=\\\"script\\\"></span>\\r\\n            </span>\\r\\n            <span id=\\\"external-resources-btn\\\" class=\\\"hint--top-left\\\" data-hint=\\\"External Resources\\\">\\r\\n              <img src=\\\"{{baseUrl}}assets/images/script-sheet.svg\\\" alt=\\\"External Resources\\\" />\\r\\n              <span id=\\\"external-resources-mark\\\" class=\\\"mark\\\"></span>\\r\\n            </span>\\r\\n          </div>\\r\\n          <button id=\\\"code-run-button\\\" class=\\\"hint--top-left\\\" data-hint=\\\"Run (Shift + Enter)\\\">\\r\\n            <img\\r\\n              width=\\\"20\\\"\\r\\n              height=\\\"20\\\"\\r\\n              alt=\\\"Run\\\"\\r\\n              src=\\\"{{baseUrl}}assets/images/play.svg\\\"\\r\\n              loading=\\\"lazy\\\"\\r\\n            />\\r\\n          </button>\\r\\n        </div>\\r\\n        <div id=\\\"output\\\">\\r\\n          <div id=\\\"result\\\" class=\\\"full\\\"></div>\\r\\n          <div id=\\\"tools-pane\\\"></div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n    <div id=\\\"overlay\\\" style=\\\"display: none\\\"></div>\\r\\n    <div id=\\\"modal-container\\\" style=\\\"display: none\\\">\\r\\n      <div id=\\\"modal\\\"></div>\\r\\n    </div>\\r\\n    <script src=\\\"https://polyfill.io/v3/polyfill.min.js\\\" crossorigin=\\\"anonymous\\\"></script>\\r\\n    <script>\\r\\n      window.appCDN = '{{appCDN}}';\\r\\n    </script>\\r\\n    {{codemirrorModule}}\\r\\n    <script type=\\\"module\\\">\\r\\n      import { app } from '{{baseUrl}}{{script}}';\\r\\n      window.app = app;\\r\\n    </script>\\r\\n  </body>\\r\\n</html>\\r\\n\"","import type { CustomEvents } from '../models';\r\n\r\nexport const customEvents: CustomEvents = {\r\n  getConfig: 'livecodes-get-config',\r\n  config: 'livecodes-config',\r\n  load: 'livecodes-load',\r\n  appLoaded: 'livecodes-app-loaded',\r\n  ready: 'livecodes-ready',\r\n  change: 'livecodes-change',\r\n  testResults: 'livecodes-test-results',\r\n  destroy: 'livecodes-destroy',\r\n  resizeEditor: 'livecodes-resize-editor',\r\n  apiResponse: 'livecodes-api-response',\r\n};\r\n","import type { Config, Language, Processor, WorkerMessageEvent } from '../models';\r\n\r\nexport const debounce = (fn: (...x: any[]) => any, delay: number | (() => number)) => {\r\n  let timeout: any;\r\n\r\n  return (...args: unknown[]) => {\r\n    if (timeout) clearTimeout(timeout);\r\n    timeout = setTimeout(() => fn.apply(null, args), typeof delay === 'function' ? delay() : delay);\r\n  };\r\n};\r\n\r\nexport const decodeHTML = (html: string) => {\r\n  const txt = document.createElement('textarea');\r\n  txt.innerHTML = html;\r\n  return txt.value;\r\n};\r\n\r\nexport const encodeHTML = (html: string) =>\r\n  html\r\n    .replace(/&/g, '&amp;')\r\n    .replace(/</g, '&lt;')\r\n    .replace(/>/g, '&gt;')\r\n    .replace(/'/g, '&#39;')\r\n    .replace(/\"/g, '&#34;');\r\n\r\nexport const escapeScript = (code: string) => code.replace(/<\\/script>/g, '<\\\\/script>');\r\n\r\nexport const escapeCode = (code: string, slash = true) =>\r\n  code\r\n    .replace(/\\\\/g, slash ? '\\\\\\\\' : '\\\\')\r\n    .replace(/`/g, '\\\\`')\r\n    .replace(/<\\/script>/g, '<\\\\/script>');\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nexport const pipe = (...fns: Function[]) =>\r\n  fns.reduce(\r\n    (f, g) =>\r\n      (...args: any) =>\r\n        g(f(...args)),\r\n  );\r\n\r\n// replace non-alphanumeric with underscore\r\nexport const safeName = (name: string, symbol = '_') => name.replace(/[\\W]+/g, symbol);\r\n\r\n// from https://stackoverflow.com/questions/11381673/detecting-a-mobile-browser\r\n// added safari (on mac & ios): monaco editor is broken on safari\r\nexport const isMobile = () => {\r\n  let mobile = false;\r\n  const userAgent = navigator.userAgent.toLowerCase();\r\n  (function (a) {\r\n    if (\r\n      /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(\r\n        a,\r\n      ) ||\r\n      /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\r\n        a.substr(0, 4),\r\n      )\r\n    ) {\r\n      mobile = true;\r\n    }\r\n  })(userAgent || navigator.vendor || (window as any).opera);\r\n\r\n  const safari = userAgent.indexOf('safari') > -1 && userAgent.indexOf('chrome') === -1; // chrome says it is safari!\r\n\r\n  return mobile || safari;\r\n};\r\n\r\nexport const isRelativeUrl = (url?: string) =>\r\n  !url?.startsWith('http') && !url?.startsWith('data:');\r\n\r\nexport const getAbsoluteUrl = (url: string, baseUrl = document.baseURI) =>\r\n  isRelativeUrl(url) ? new URL(url, baseUrl).href : url;\r\n\r\nexport const cloneObject = <T>(x: Record<string, any>): T => JSON.parse(JSON.stringify(x));\r\n\r\nexport const objectMap = (\r\n  obj: Record<string, any>,\r\n  fn: (value: any, key: string, index: number) => any,\r\n) => Object.fromEntries(Object.entries(obj).map(([k, v], i) => [k, fn(v, k, i)]));\r\n\r\nexport const objectFilter = (\r\n  obj: Record<string, any>,\r\n  predicate: (value: any, key: string, index: number) => any,\r\n) => Object.fromEntries(Object.entries(obj).filter(([k, v], i) => predicate(v, k, i)));\r\n\r\nexport const copyToClipboard = (text: string) => {\r\n  if (document.queryCommandSupported && document.queryCommandSupported('copy')) {\r\n    const textarea = document.createElement('textarea');\r\n    textarea.textContent = text;\r\n    textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page in Microsoft Edge.\r\n    document.body.appendChild(textarea);\r\n    textarea.select();\r\n    try {\r\n      return document.execCommand('copy'); // Security exception may be thrown by some browsers.\r\n    } catch (ex) {\r\n      // eslint-disable-next-line no-console\r\n      console.warn('Copy to clipboard failed.', ex);\r\n      return false;\r\n    } finally {\r\n      document.body.removeChild(textarea);\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const stringToValidJson = (str: string) =>\r\n  str\r\n    .replace(/'[^'\"]*'(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/g, function replaceSingleQuotes(matchedStr) {\r\n      return '\"' + matchedStr.substring(1, matchedStr.length - 1) + '\"';\r\n    })\r\n    .replace(\r\n      /(\\w+(?=([^\"\\\\]*(\\\\.|\"([^\"\\\\]*\\\\.)*[^\"\\\\]*\"))*[^\"]*$))(\\s*:)(?!(\\w*)(?:\"))/gm,\r\n      function quoteNonQuoted(matchedStr) {\r\n        return '\"' + matchedStr.substring(0, matchedStr.length - 1).trimEnd() + '\":';\r\n      },\r\n    )\r\n    .replace(/,\\s*([\\]}])/g, '$1'); // remove trailing comma\r\n\r\nexport const stringify = (obj: any, pretty = false) => {\r\n  try {\r\n    return JSON.stringify(obj, undefined, pretty ? 2 : undefined);\r\n  } catch {\r\n    return '';\r\n  }\r\n};\r\n\r\nexport const getRandomString = () => String(Math.random()) + '-' + Date.now().toFixed();\r\n\r\nexport const downloadFile = (filename: string, extension: string, content: string) => {\r\n  const a = document.createElement('a');\r\n  a.style.display = 'none';\r\n  a.href = content;\r\n  a.download = safeName(filename) + '.' + extension;\r\n  a.click();\r\n  a.remove();\r\n};\r\n\r\nexport const loadScript = (url: string, name?: string) =>\r\n  new Promise((resolve, reject) => {\r\n    if (name && (globalThis as any)[name]) {\r\n      return resolve((globalThis as any)[name]);\r\n    }\r\n\r\n    // if running in web worker\r\n    if (typeof (globalThis as any).importScripts === 'function') {\r\n      (globalThis as any).importScripts(url);\r\n      if (name && (globalThis as any)[name]) {\r\n        return resolve((globalThis as any)[name]);\r\n      }\r\n      return resolve(globalThis);\r\n    }\r\n\r\n    const script = document.createElement('script');\r\n    script.src = url;\r\n    script.async = true;\r\n    const removeEventListeners = () => {\r\n      script.removeEventListener('load', onLoad);\r\n      script.removeEventListener('error', onError);\r\n    };\r\n    const onLoad = () => {\r\n      removeEventListeners();\r\n      if (!name) {\r\n        return resolve('loaded: ' + url);\r\n      }\r\n      const i = setInterval(() => {\r\n        if ((window as any)[name]) {\r\n          clearInterval(i);\r\n          return resolve((window as any)[name]);\r\n        }\r\n      }, 5);\r\n    };\r\n    const onError = () => {\r\n      removeEventListeners();\r\n      reject('failed to load: ' + url);\r\n    };\r\n    script.addEventListener('load', onLoad);\r\n    script.addEventListener('error', onError);\r\n    document.head.appendChild(script);\r\n  });\r\n\r\nexport const loadStylesheet = (url: string, id?: string, insertBefore?: string) => {\r\n  if (id && document.getElementById(id)) return;\r\n  const stylesheet = document.createElement('link');\r\n  stylesheet.rel = 'stylesheet';\r\n  stylesheet.href = url;\r\n  stylesheet.id = id || 'styles-' + getRandomString();\r\n  document.head.insertBefore(\r\n    stylesheet,\r\n    insertBefore ? document.querySelector(insertBefore) : null,\r\n  );\r\n};\r\n\r\nexport const typedArrayToBuffer = (array: Uint8Array): ArrayBuffer =>\r\n  array.buffer.slice(array.byteOffset, array.byteLength + array.byteOffset);\r\n\r\nexport const getDate = () => {\r\n  let date = new Date();\r\n  const offset = date.getTimezoneOffset();\r\n  date = new Date(date.getTime() - offset * 60 * 1000);\r\n  return date.toISOString().split('T')[0];\r\n};\r\n\r\nexport const handleFetchError = (res: Response) => (res.ok ? res : Promise.reject());\r\nexport const fetchWithHandler = (input: RequestInfo, init?: RequestInit) =>\r\n  fetch(input, init).then(handleFetchError);\r\n\r\nexport const blobToBase64 = (file: Blob): Promise<string> =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => (typeof reader.result === 'string' ? resolve(reader.result) : reject());\r\n    reader.onerror = (error) => reject(error);\r\n  });\r\n\r\nexport const Uint8ArrayToBase64 = (u8: Uint8Array) => {\r\n  const CHUNK_SZ = 0x8000;\r\n  const c = [];\r\n  for (let i = 0; i < u8.length; i += CHUNK_SZ) {\r\n    c.push(String.fromCharCode.apply(null, (u8 as any).subarray(i, i + CHUNK_SZ)));\r\n  }\r\n  return btoa(c.join(''));\r\n};\r\n\r\nexport const base64ToUint8Array = (str: string) =>\r\n  new Uint8Array(\r\n    atob(str)\r\n      .split('')\r\n      .map((c) => c.charCodeAt(0)),\r\n  );\r\n\r\nexport const typedArraysAreEqual = (a: Uint8Array, b: Uint8Array) => {\r\n  if (a === b) {\r\n    return true;\r\n  }\r\n  if (a.byteLength !== b.byteLength) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < a.byteLength; i++) {\r\n    if (a[i] !== b[i]) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n};\r\n\r\nexport const getWorkerDataURL = (url: string) => {\r\n  const content = `importScripts(\"${url}\");`;\r\n  return 'data:text/javascript;base64,' + btoa(content);\r\n};\r\n\r\nexport const removeComments = (src: string) =>\r\n  src.replace(/\\/\\*[\\s\\S]*?\\*\\/|([^\\\\:]|^)\\/\\/.*$/gm, '$1');\r\n\r\nexport const removeStrings = (src: string) =>\r\n  src\r\n    .replace(/'[^\\n']*'/gm, \"''\")\r\n    .replace(/\"[^\\n\"]*\"/gm, '\"\"')\r\n    .replace(/`[^`]*`/gm, '``');\r\n\r\nexport const removeCommentsAndStrings = (src: string) => removeStrings(removeComments(src));\r\n\r\nexport const getLanguageCustomSettings = (language: Language | Processor, config: Config) => ({\r\n  ...(config.customSettings as any)[language],\r\n});\r\n\r\nexport const getValidUrl = (url?: string) => {\r\n  if (!url) return null;\r\n  let validUrl = null;\r\n  if (url.startsWith('http') || url.startsWith('data:')) {\r\n    try {\r\n      validUrl = new URL(url).href;\r\n    } catch {\r\n      try {\r\n        validUrl = new URL(decodeURIComponent(url)).href;\r\n      } catch {\r\n        //\r\n      }\r\n    }\r\n  }\r\n  return validUrl;\r\n};\r\n\r\nexport const runOrContinue =\r\n  <T>(fn: (x: T) => Promise<T>, catchFn?: (err: unknown) => void) =>\r\n  async (x: T): Promise<T> => {\r\n    try {\r\n      const result = await fn(x);\r\n      return result;\r\n    } catch (error) {\r\n      if (typeof catchFn === 'function') {\r\n        catchFn(error);\r\n      }\r\n      return x;\r\n    }\r\n  };\r\n\r\nexport const getFileExtension = (file: string) => file.split('.')[file.split('.').length - 1];\r\n\r\nexport const isInIframe = () => {\r\n  try {\r\n    return window.self !== window.top;\r\n  } catch {\r\n    return true;\r\n  }\r\n};\r\n\r\nexport const indentCode = (code: string, spaces: number, skipFirstLine = true) =>\r\n  (skipFirstLine ? '' : ' '.repeat(spaces)) + code.split('\\n').join('\\n' + ' '.repeat(spaces));\r\n\r\nexport const hideOnClickOutside = (element: HTMLElement) => {\r\n  const hideElement = () => {\r\n    element.style.display = 'none';\r\n    removeListeners();\r\n    (window as any).watchingEscape = false;\r\n  };\r\n\r\n  const outsideClickListener = (event: MouseEvent) => {\r\n    if (!element.contains(event.target as Node) && isVisible(element)) {\r\n      hideElement();\r\n    }\r\n  };\r\n\r\n  const escapeListener = (event: KeyboardEvent) => {\r\n    if (event.key === 'Escape') {\r\n      hideElement();\r\n      event.preventDefault();\r\n    }\r\n  };\r\n\r\n  const isVisible = (elem: HTMLElement) =>\r\n    !!elem && !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\r\n\r\n  const removeListeners = () => {\r\n    document.removeEventListener('click', outsideClickListener);\r\n    document.removeEventListener('keydown', escapeListener);\r\n  };\r\n\r\n  document.addEventListener('click', outsideClickListener);\r\n  document.addEventListener('keydown', escapeListener);\r\n  (window as any).watchingEscape = true;\r\n\r\n  return {\r\n    clear: () => removeListeners(),\r\n  };\r\n};\r\n\r\nexport const callWorker = async <T = string, K = unknown>(\r\n  worker: Worker,\r\n  message: { method: T; args?: any },\r\n) =>\r\n  new Promise<K>((resolve) => {\r\n    const messageId = getRandomString();\r\n\r\n    const handler = (event: WorkerMessageEvent<T, K>) => {\r\n      const received = event.data;\r\n\r\n      if (received.method === message.method && received.messageId === messageId) {\r\n        worker.removeEventListener('message', handler);\r\n        resolve(received.data as K);\r\n      }\r\n    };\r\n    worker.addEventListener('message', handler);\r\n\r\n    worker.postMessage({\r\n      ...message,\r\n      messageId,\r\n    });\r\n  });\r\n\r\nexport const toCamelCase = (str: string) =>\r\n  str\r\n    .replace(/[-_.]+/g, ' ')\r\n    .trim()\r\n    .replace(/^([A-Z])|\\s+(\\w)/g, function (_match, p1, p2) {\r\n      if (p2) return p2.toUpperCase();\r\n      return p1.toLowerCase();\r\n    });\r\n\r\nexport const removeDuplicates = (arr: any[] | undefined) => Array.from(new Set(arr));\r\n","import type { CDN } from '../models';\r\n\r\ndeclare const globalThis: { appCDN: CDN };\r\n\r\nconst moduleCDNs: CDN[] = ['jspm', 'skypack'];\r\nconst npmCDNs: CDN[] = ['unpkg', 'jsdelivr'];\r\nconst ghCDNs: CDN[] = ['jsdelivr.gh', 'statically'];\r\n\r\nexport const modulesService = {\r\n  getModuleUrl: (\r\n    moduleName: string,\r\n    { isModule = true, defaultCDN = 'jspm' }: { isModule?: boolean; defaultCDN?: CDN } = {},\r\n  ) => {\r\n    moduleName = moduleName.replace(/#nobundle/g, '');\r\n\r\n    const moduleUrl = getCdnUrl(moduleName, isModule, defaultCDN);\r\n    if (moduleUrl) {\r\n      return moduleUrl;\r\n    }\r\n\r\n    return isModule\r\n      ? 'https://jspm.dev/' + moduleName\r\n      : 'https://cdn.jsdelivr.net/npm/' + moduleName;\r\n  },\r\n\r\n  getUrl: (path: string, cdn?: CDN) =>\r\n    path.startsWith('http') ? path : getCdnUrl(path, false, cdn || getAppCDN()) || path,\r\n\r\n  cdnLists: { npm: npmCDNs, module: moduleCDNs, gh: ghCDNs },\r\n\r\n  checkCDNs: async (testModule: string, preferredCDN?: CDN) => {\r\n    const cdns: CDN[] = [preferredCDN, ...modulesService.cdnLists.npm].filter(Boolean) as CDN[];\r\n    for (const cdn of cdns) {\r\n      try {\r\n        const res = await fetch(modulesService.getUrl(testModule, cdn), {\r\n          method: 'HEAD',\r\n        });\r\n        if (res.ok) return cdn;\r\n      } catch {\r\n        // continue;\r\n      }\r\n    }\r\n    // fall back to first\r\n    return modulesService.cdnLists.npm[0];\r\n  },\r\n};\r\n\r\nexport const getAppCDN = (): CDN => {\r\n  if (globalThis.appCDN) return globalThis.appCDN;\r\n  try {\r\n    const url = new URL(location.href);\r\n    return (url.searchParams.get('appCDN') as CDN) || modulesService.cdnLists.npm[0];\r\n  } catch {\r\n    return modulesService.cdnLists.npm[0] as CDN;\r\n  }\r\n};\r\n\r\nconst getCdnUrl = (modName: string, isModule: boolean, defaultCDN?: CDN) => {\r\n  const post = isModule && modName.startsWith('unpkg:') ? '?module' : '';\r\n  if (modName.startsWith('gh:')) {\r\n    modName = modName.replace('gh', ghCDNs[0]);\r\n  } else if (!modName.includes(':')) {\r\n    const prefix = defaultCDN || (isModule ? moduleCDNs[0] : npmCDNs[0]);\r\n    modName = prefix + ':' + modName;\r\n  }\r\n  for (const i of TEMPLATES) {\r\n    const [pattern, template] = i;\r\n    if (pattern.test(modName)) {\r\n      return modName.replace(pattern, template) + post;\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\n// based on https://github.com/neoascetic/rawgithack/blob/master/web/rawgithack.js\r\nconst TEMPLATES: Array<[RegExp, string]> = [\r\n  [/^(jspm:)(.+)/i, 'https://jspm.dev/$2'],\r\n\r\n  [/^(npm:)(.+)/i, 'https://jspm.dev/$2'],\r\n\r\n  [/^(node:)(.+)/i, 'https://jspm.dev/$2'],\r\n\r\n  [/^(skypack:)(.+)/i, 'https://cdn.skypack.dev/$2'],\r\n\r\n  [/^(jsdelivr:)(.+)/i, 'https://cdn.jsdelivr.net/npm/$2'],\r\n\r\n  [/^(jsdelivr.gh:)(.+)/i, 'https://cdn.jsdelivr.net/gh/$2'],\r\n\r\n  [/^(statically:)(.+)/i, 'https://cdn.statically.io/gh/$2'],\r\n\r\n  [/^(esm.run:)(.+)/i, 'https://esm.run/$2'],\r\n\r\n  [/^(esm.sh:)(.+)/i, 'https://esm.sh/$2'],\r\n\r\n  [/^(esbuild:)(.+)/i, 'https://esbuild.vercel.app/$2'],\r\n\r\n  [/^(bundle.run:)(.+)/i, 'https://bundle.run/$2'],\r\n\r\n  [/^(unpkg:)(.+)/i, 'https://unpkg.com/$2'],\r\n\r\n  [/^(bundlejs:)(.+)/i, 'https://deno.bundlejs.com/?file&q=$2'],\r\n\r\n  [/^(bundle:)(.+)/i, 'https://deno.bundlejs.com/?file&q=$2'],\r\n\r\n  [/^(deno:)(.+)/i, 'https://deno.bundlejs.com/?file&q=https://deno.land/x/$2/mod.ts'],\r\n\r\n  [/^(https:\\/\\/deno\\.land\\/.+)/i, 'https://deno.bundlejs.com/?file&q=$1'],\r\n\r\n  [\r\n    /^(github:|https:\\/\\/github\\.com\\/)(.[^\\/]+?)\\/(.[^\\/]+?)\\/(?!releases\\/)(?:(?:blob|raw)\\/)?(.+?\\/.+)/i,\r\n    'https://deno.bundlejs.com/?file&q=https://cdn.jsdelivr.net/gh/$2/$3@$4',\r\n  ],\r\n\r\n  [/^(gist\\.github:)(.+?\\/[0-9a-f]+\\/raw\\/(?:[0-9a-f]+\\/)?.+)$/i, 'https://gist.githack.com/$2'],\r\n\r\n  [\r\n    /^(gitlab:|https:\\/\\/gitlab\\.com\\/)([^\\/]+.*\\/[^\\/]+)\\/(?:raw|blob)\\/(.+?)(?:\\?.*)?$/i,\r\n    'https://deno.bundlejs.com/?file&q=https://gl.githack.com/$2/raw/$3',\r\n  ],\r\n  [\r\n    /^(bitbucket:|https:\\/\\/bitbucket\\.org\\/)([^\\/]+\\/[^\\/]+)\\/(?:raw|src)\\/(.+?)(?:\\?.*)?$/i,\r\n    'https://deno.bundlejs.com/?file&q=https://bb.githack.com/$2/raw/$3',\r\n  ],\r\n\r\n  // snippet file URL from web interface, with revision\r\n  [\r\n    /^(bitbucket:)snippets\\/([^\\/]+\\/[^\\/]+)\\/revisions\\/([^\\/\\#\\?]+)(?:\\?[^#]*)?(?:\\#file-(.+?))$/i,\r\n    'https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4',\r\n  ],\r\n  // snippet file URL from web interface, no revision\r\n  [\r\n    /^(bitbucket:)snippets\\/([^\\/]+\\/[^\\/\\#\\?]+)(?:\\?[^#]*)?(?:\\#file-(.+?))$/i,\r\n    'https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3',\r\n  ],\r\n  // snippet file URLs from REST API\r\n  [\r\n    /^(bitbucket:)\\!api\\/2.0\\/snippets\\/([^\\/]+\\/[^\\/]+\\/[^\\/]+)\\/files\\/(.+?)(?:\\?.*)?$/i,\r\n    'https://bb.githack.com/!api/2.0/snippets/$2/files/$3',\r\n  ],\r\n  [\r\n    /^(api\\.bitbucket:)2.0\\/snippets\\/([^\\/]+\\/[^\\/]+\\/[^\\/]+)\\/files\\/(.+?)(?:\\?.*)?$/i,\r\n    'https://bb.githack.com/!api/2.0/snippets/$2/files/$3',\r\n  ],\r\n\r\n  [/^(rawgit:)(.+?\\/[0-9a-f]+\\/raw\\/(?:[0-9a-f]+\\/)?.+)$/i, 'https://gist.githack.com/$2'],\r\n  [\r\n    /^(rawgit:|https:\\/\\/raw\\.githubusercontent\\.com)(\\/[^\\/]+\\/[^\\/]+|[0-9A-Za-z-]+\\/[0-9a-f]+\\/raw)\\/(.+)/i,\r\n    'https://deno.bundlejs.com/?file&q=https://raw.githack.com/$2/$3',\r\n  ],\r\n];\r\n","// eslint-disable-next-line import/no-internal-modules\r\nimport { modulesService } from './services/modules';\r\n\r\nconst { getUrl, getModuleUrl } = modulesService;\r\n\r\nexport const vendorsBaseUrl = // 'http://127.0.0.1:8081/';\r\n  /* @__PURE__ */ getUrl('@live-codes/browser-compilers@0.7.4/dist/');\r\n\r\nexport const acornUrl = /* @__PURE__ */ getUrl('acorn@8.8.2/dist/acorn.js');\r\n\r\nexport const artTemplateUrl = /* @__PURE__ */ getUrl('art-template@4.13.2/lib/template-web.js');\r\n\r\nexport const asciidocUrl = /* @__PURE__ */ getUrl(\r\n  '@asciidoctor/core@2.2.6/dist/browser/asciidoctor.js',\r\n);\r\n\r\nexport const assemblyscriptLoaderUrl = /* @__PURE__ */ getUrl(\r\n  '@assemblyscript/loader@0.27.5/umd/index.js',\r\n);\r\n\r\nexport const astringUrl = /* @__PURE__ */ getUrl('astring@1.8.1/dist/astring.min.js');\r\n\r\nexport const astroBaseUrl = /* @__PURE__ */ getUrl('@hatemhosny/astro-internal@0.0.4/');\r\n\r\nexport const astroWasmURL = /* @__PURE__ */ getUrl('@astrojs/compiler@0.9.2/astro.wasm');\r\n\r\nexport const autoCompleteUrl = /* @__PURE__ */ getUrl(\r\n  '@tarekraafat/autocomplete.js@10.2.6/dist/autoComplete.js',\r\n);\r\n\r\nexport const babelUrl = /* @__PURE__ */ getUrl('@babel/standalone@7.22.4/babel.js');\r\n\r\nexport const biwaschemeUrl = /* @__PURE__ */ getUrl('biwascheme@0.8.0/release/biwascheme.js');\r\n\r\nexport const blocklyCdnBaseUrl = /* @__PURE__ */ getUrl('blockly@9.3.3/');\r\n\r\nexport const brythonBaseUrl = /* @__PURE__ */ getUrl('brython@3.11.2/');\r\n\r\nexport const chaiUrl = /* @__PURE__ */ getModuleUrl('chai@4.3.6');\r\n\r\nexport const chaiTypesUrl = /* @__PURE__ */ getUrl('@types/chai@4.2.22/index.d.ts');\r\n\r\nexport const cherryCljsBaseUrl = /* @__PURE__ */ getUrl('cherry-cljs@0.0.4/');\r\n\r\nexport const cjs2esUrl = /* @__PURE__ */ getUrl('cjs2es@1.1.1/dist/cjs2es.browser.js');\r\n\r\nexport const clioBaseUrl = /* @__PURE__ */ getUrl(\r\n  '@live-codes/clio-browser-compiler@0.0.3/public/build/',\r\n);\r\n\r\nexport const coffeeScriptUrl = /* @__PURE__ */ getUrl(\r\n  'coffeescript@2.7.0/lib/coffeescript-browser-compiler-legacy/coffeescript.js',\r\n);\r\n\r\nexport const cppWasmBaseUrl = /* @__PURE__ */ getUrl('@chriskoch/cpp-wasm@1.0.2');\r\n\r\nexport const csstreeUrl = /* @__PURE__ */ getUrl('css-tree@1.1.3/dist/csstree.js');\r\n\r\nexport const cytoscapeSvgUrl = /* @__PURE__ */ getUrl('cytoscape-svg@0.4.0/cytoscape-svg.js');\r\n\r\nexport const cytoscapeUrl = /* @__PURE__ */ getUrl('cytoscape@3.25.0/dist/cytoscape.min.js');\r\n\r\nexport const dotUrl = /* @__PURE__ */ getUrl('dot@1.1.3/doT.js');\r\n\r\nexport const ejsUrl = /* @__PURE__ */ getUrl('ejs@3.1.9/ejs.js');\r\n\r\nexport const elkjsBaseUrl = /* @__PURE__ */ getUrl('elkjs@0.8.2/lib/');\r\n\r\nexport const emmetMonacoUrl = /* @__PURE__ */ getUrl('emmet-monaco-es@5.0.0/dist/emmet-monaco.js');\r\n\r\nexport const esModuleShimsPath = 'es-module-shims@1.4.4/dist/es-module-shims.js';\r\n\r\nexport const etaUrl = /* @__PURE__ */ getUrl('eta@2.2.0/dist/eta.umd.js');\r\n\r\nexport const flexSearchUrl = /* @__PURE__ */ getUrl('flexsearch@0.7.21/dist/flexsearch.bundle.js');\r\n\r\nexport const fontAnonymousProUrl = /* @__PURE__ */ getUrl(\r\n  '@fontsource/anonymous-pro@4.5.9/index.css',\r\n);\r\n\r\nexport const fontCascadiaCodeUrl = /* @__PURE__ */ getUrl(\r\n  '@fontsource/cascadia-code@4.2.1/index.css',\r\n);\r\n\r\nexport const fontCodeNewRomanUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.cdnfonts.com/css/code-new-roman-2',\r\n);\r\n\r\nexport const fontComicMonoUrl = /* @__PURE__ */ getUrl('comic-mono@0.0.1/index.css');\r\n\r\nexport const fontCourierPrimeUrl = /* @__PURE__ */ getUrl(\r\n  '@fontsource/courier-prime@4.5.9/index.css',\r\n);\r\n\r\nexport const fontDECTerminalModernUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.cdnfonts.com/css/dec-terminal-modern',\r\n);\r\n\r\nexport const fontDejaVuMonoUrl = /* @__PURE__ */ getUrl('@fontsource/dejavu-mono@4.5.4/index.css');\r\n\r\nexport const fontFantasqueUrl = /* @__PURE__ */ getUrl(\r\n  '@typopro/web-fantasque-sans-mono@3.7.5/TypoPRO-FantasqueSansMono.css',\r\n);\r\n\r\nexport const fontFiraCodeUrl = /* @__PURE__ */ getUrl('firacode@6.2.0/distr/fira_code.css');\r\n\r\nexport const fontFixedsysUrl = /* @__PURE__ */ getUrl('https://fonts.cdnfonts.com/css/fixedsys-62');\r\n\r\nexport const fontHackUrl = /* @__PURE__ */ getUrl('hack-font@3.3.0/build/web/hack.css');\r\n\r\nexport const fontHermitUrl = /* @__PURE__ */ getUrl('typeface-hermit@0.0.44/index.css');\r\n\r\nexport const fontIBMPlexMonoUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap',\r\n);\r\n\r\nexport const fontInconsolataUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.googleapis.com/css2?family=Inconsolata&display=swap',\r\n);\r\n\r\nexport const fontIosevkaUrl = /* @__PURE__ */ getUrl('@fontsource/iosevka@4.5.4/index.css');\r\n\r\nexport const fontJetbrainsMonoUrl = /* @__PURE__ */ getUrl(\r\n  '@fontsource/jetbrains-mono@4.5.11/index.css',\r\n);\r\n\r\nexport const fontMenloUrl = /* @__PURE__ */ getUrl('https://fonts.cdnfonts.com/css/menlo');\r\n\r\nexport const fontMonofurUrl = /* @__PURE__ */ getUrl('https://fonts.cdnfonts.com/css/monofur');\r\n\r\nexport const fontMonoidUrl = /* @__PURE__ */ getUrl('@typopro/web-monoid@3.7.5/TypoPRO-Monoid.css');\r\n\r\nexport const fontNotoUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.googleapis.com/css2?family=Noto+Sans+Mono&display=swap',\r\n);\r\n\r\nexport const fontNovaMonoUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.googleapis.com/css2?family=Nova+Mono&display=swap',\r\n);\r\n\r\nexport const fontOpenDyslexicUrl = /* @__PURE__ */ getUrl(\r\n  '@fontsource/opendyslexic@4.5.4/index.css',\r\n);\r\n\r\nexport const fontProFontWindowsUrl = /* @__PURE__ */ getUrl(\r\n  'https://fonts.cdnfonts.com/css/profontwindows',\r\n);\r\n\r\nexport const fontRobotoMonoUrl = /* @__PURE__ */ getUrl('@fontsource/roboto-mono@4.5.8/index.css');\r\n\r\nexport const fontSFMonoUrl = /* @__PURE__ */ getUrl('https://fonts.cdnfonts.com/css/sf-mono');\r\n\r\nexport const fontSourceCodeProUrl = /* @__PURE__ */ getUrl(\r\n  '@fontsource/source-code-pro@4.5.12/index.css',\r\n);\r\n\r\nexport const fontSpaceMonoUrl = /* @__PURE__ */ getUrl('@fontsource/space-mono@4.5.10/index.css');\r\n\r\nexport const fontSudoVarUrl = /* @__PURE__ */ getUrl('https://fonts.cdnfonts.com/css/sudo-var');\r\n\r\nexport const fontUbuntuMonoUrl = /* @__PURE__ */ getUrl('@fontsource/ubuntu-mono@4.5.11/index.css');\r\n\r\nexport const fontVictorMonoUrl = /* @__PURE__ */ getUrl('victormono@1.5.4/dist/index.css');\r\n\r\nexport const fscreenUrl = /* @__PURE__ */ getUrl('fscreen@1.2.0/dist/fscreen.esm.js');\r\n\r\nexport const githubMarkdownCss = /* @__PURE__ */ getUrl(\r\n  'github-markdown-css@5.1.0/github-markdown.css',\r\n);\r\n\r\nexport const go2jsBaseUrl = /* @__PURE__ */ getUrl('@live-codes/go2js@0.4.0/build/');\r\n\r\nexport const graphreCdnUrl = /* @__PURE__ */ getUrl('graphre@0.1.3/dist/graphre.js');\r\n\r\nexport const handlebarsBaseUrl = /* @__PURE__ */ getUrl('handlebars@4.7.7/dist/');\r\n\r\nexport const highlightjsUrl = /* @__PURE__ */ getModuleUrl('highlight.js@11.5.1');\r\n\r\nexport const hintCssUrl = /* @__PURE__ */ getUrl('hint.css@2.7.0/hint.css');\r\n\r\nexport const hpccJsCdnUrl = /* @__PURE__ */ getUrl('@hpcc-js/wasm@2.13.0/dist/index.js');\r\n\r\nexport const imbaBaseUrl = /* @__PURE__ */ getUrl('imba@2.0.0-alpha.229/dist/');\r\n\r\nexport const jestLiteUrl = /* @__PURE__ */ getUrl('jest-lite@1.0.0-alpha.4/dist/core.js');\r\n\r\nexport const jestTypesUrl = /* @__PURE__ */ getUrl('@types/jest@27.4.1/index.d.ts');\r\n\r\nexport const jsclUrl = /* @__PURE__ */ getUrl(\r\n  'gh:jscl-project/jscl-project.github.io@efd3aecdba496d132ed650b7b5be976fd0ca278f/jscl.js',\r\n);\r\n\r\nexport const jsZipUrl = /* @__PURE__ */ getUrl('jszip@3.10.1/dist/jszip.js');\r\n\r\nexport const juliaWasmBaseUrl = /* @__PURE__ */ getUrl('@chriskoch/julia-wasm@1.0.4');\r\n\r\nexport const liquidJsUrl = /* @__PURE__ */ getUrl('liquidjs@10.8.2/dist/liquid.browser.min.js');\r\n\r\nexport const localforageUrl = /* @__PURE__ */ getUrl('localforage@1.10.0/dist/localforage.js');\r\n\r\nexport const luaUrl = /* @__PURE__ */ getUrl('fengari-web@0.1.4/dist/fengari-web.js');\r\n\r\nexport const lunaObjViewerStylesUrl = /* @__PURE__ */ getUrl(\r\n  'luna-object-viewer@0.2.0/luna-object-viewer.css',\r\n);\r\n\r\nexport const lunaConsoleStylesUrl = /* @__PURE__ */ getUrl('luna-console@0.2.1/luna-console.css');\r\n\r\nexport const malinaVersion = '0.6.64';\r\nexport const malinaUrl = /* @__PURE__ */ getUrl(`malinajs@${malinaVersion}/malina.js`);\r\n\r\nexport const markedUrl = /* @__PURE__ */ getUrl('marked@5.0.4/marked.min.js');\r\n\r\nexport const mermaidCdnUrl = /* @__PURE__ */ getUrl('mermaid@10.2.2/dist/mermaid.esm.mjs');\r\n\r\nexport const mjmlUrl = /* @__PURE__ */ getUrl('mjml-browser@4.14.1/lib/index.js');\r\n\r\nexport const monacoEmacsUrl = /* @__PURE__ */ getUrl('monaco-emacs@0.3.0/dist/monaco-emacs.js');\r\n\r\nexport const monacoVimUrl = /* @__PURE__ */ getUrl('monaco-vim@0.4.0/dist/monaco-vim.js');\r\n\r\nexport const mustacheUrl = /* @__PURE__ */ getUrl('mustache@4.2.0/mustache.js');\r\n\r\nexport const nomnomlCdnUrl = /* @__PURE__ */ getUrl('nomnoml@1.6.1/dist/nomnoml.js');\r\n\r\nexport const normalizeCssUrl = /* @__PURE__ */ getUrl('normalize.css@8.0.1/normalize.css');\r\n\r\nexport const nunjucksBaseUrl = /* @__PURE__ */ getUrl('nunjucks@3.2.4/browser/');\r\n\r\nexport const opalBaseUrl = /* @__PURE__ */ getUrl('https://cdn.opalrb.com/opal/1.7.3/');\r\n\r\nexport const parinferUrl = /* @__PURE__ */ getUrl('parinfer@3.13.1/parinfer.js');\r\n\r\nexport const pintoraUrl = /* @__PURE__ */ getUrl(\r\n  '@pintora/standalone@0.6.2/lib/pintora-standalone.umd.js',\r\n);\r\n\r\nexport const plotlyCdnUrl = /* @__PURE__ */ getUrl('plotly.js@2.23.2/dist/plotly.js');\r\n\r\nexport const postcssImportUrlUrl = /* @__PURE__ */ getUrl(\r\n  '@live-codes/postcss-import-url@0.1.2/dist/postcss-import-url.js',\r\n);\r\n\r\nexport const prettierBaseUrl = /* @__PURE__ */ getUrl('prettier@2.5.1/');\r\n\r\nexport const prettierPhpUrl = /* @__PURE__ */ getUrl('@prettier/plugin-php@0.18.0/standalone.js');\r\n\r\nexport const prismBaseUrl = /* @__PURE__ */ getUrl('prismjs@1.26.0/components/');\r\n\r\nexport const pyodideBaseUrl = /* @__PURE__ */ getUrl(\r\n  'https://cdn.jsdelivr.net/pyodide/v0.23.2/full/',\r\n);\r\n\r\nexport const qrcodeUrl = /* @__PURE__ */ getUrl('qrcode-generator@1.4.4/qrcode.js');\r\n\r\nexport const quillEditorCdnBaseUrl = /* @__PURE__ */ getUrl('quill@2.0.0-dev.4/dist/');\r\n\r\nexport const quillHtmlEditUrl = /* @__PURE__ */ getUrl(\r\n  'quill-html-edit-button@2.2.7/dist/quill.htmlEditButton.min.js',\r\n);\r\n\r\nexport const quillBlotFormaterUrl = /* @__PURE__ */ getUrl(\r\n  'quill-blot-formatter@1.0.5/dist/quill-blot-formatter.min.js',\r\n);\r\n\r\nexport const quillBetterTableBaseUrl = /* @__PURE__ */ getUrl('quill-better-table@1.2.10/dist/');\r\n\r\nexport const requireUrl = /* @__PURE__ */ getUrl('requirejs@2.3.6/require.js');\r\n\r\nexport const reasonCompilerUrl = /* @__PURE__ */ getUrl(\r\n  'https://cdn.rescript-lang.org/v9.1.2/compiler.js',\r\n);\r\n\r\nexport const reasonReactUrl = /* @__PURE__ */ getUrl(\r\n  'https://cdn.rescript-lang.org/v9.1.2/%40rescript/react/cmij.js',\r\n);\r\n\r\nexport const reasonStdLibBaseUrl = /* @__PURE__ */ getUrl('@rescript/std@9.1.3/lib/es6/');\r\n\r\nexport const rescriptCompilerUrl = /* @__PURE__ */ getUrl(\r\n  'https://cdn.rescript-lang.org/v10.1.2/compiler.js',\r\n);\r\n\r\nexport const rescriptReactUrl = /* @__PURE__ */ getUrl(\r\n  'https://cdn.rescript-lang.org/v10.1.2/%40rescript/react/cmij.js',\r\n);\r\n\r\nexport const rescriptStdLibBaseUrl = /* @__PURE__ */ getUrl('@rescript/std@10.1.2/lib/es6/');\r\n\r\nexport const resetCssUrl = /* @__PURE__ */ getUrl('reset-css@5.0.1/reset.css');\r\n\r\nexport const riotBaseUrl = /* @__PURE__ */ getUrl('riot@7.1.0/');\r\n\r\nexport const snackbarUrl = /* @__PURE__ */ getUrl('@snackbar/core@1.7.0/dist/snackbar.css');\r\n\r\nexport const spacingJsUrl = /* @__PURE__ */ getUrl('spacingjs@1.0.7/dist/bundle.js');\r\n\r\nexport const sqlFormatterUrl = /* @__PURE__ */ getUrl(\r\n  'sql-formatter@12.2.1/dist/sql-formatter.min.js',\r\n);\r\n\r\nexport const sqljsBaseUrl = /* @__PURE__ */ getUrl('sql.js@1.8.0/dist/');\r\n\r\nexport const stencilUrl = /* @__PURE__ */ getUrl('@stencil/core@3.2.2/compiler/stencil.js');\r\n\r\nexport const stylisUrl = /* @__PURE__ */ getUrl('stylis@4.2.0/dist/umd/stylis.js');\r\n\r\nexport const svgbobWasmCdnUrl = /* @__PURE__ */ getUrl('svgbob-wasm@0.4.1-a0/svgbob_wasm_bg.wasm');\r\n\r\nexport const tagifyBaseUrl = /* @__PURE__ */ getUrl('@yaireo/tagify@4.9.6/dist/');\r\n\r\nexport const tailwindcssUrl = /* @__PURE__ */ getUrl(\r\n  '@mhsdesign/jit-browser-tailwindcss@0.3.0/dist/cdn.min.js',\r\n);\r\n\r\nexport const tauPrologBaseUrl = /* @__PURE__ */ getUrl('tau-prolog@0.3.4/modules/');\r\n\r\nexport const tealUrl = /* @__PURE__ */ getUrl(\r\n  'gh:teal-language/tl@d2fc36b5ff9a52d7265e63eb74cce70fd1cdbcb2/tl.lua',\r\n);\r\n\r\nexport const twigUrl = /* @__PURE__ */ getUrl('twig@1.16.0/twig.min.js');\r\n\r\nexport const typescriptUrl = /* @__PURE__ */ getUrl('typescript@5.1.3/lib/typescript.js');\r\n\r\nexport const uniterUrl = /* @__PURE__ */ getUrl('uniter@2.18.0/dist/uniter.js');\r\n\r\nexport const vegaCdnUrl = /* @__PURE__ */ getUrl('vega@5.25.0/build/vega.js');\r\n\r\nexport const vegaLiteCdnUrl = /* @__PURE__ */ getUrl('vega-lite@5.9.3/build/vega-lite.js');\r\n\r\nexport const vue3CdnUrl = /* @__PURE__ */ getUrl('vue@3');\r\n\r\nexport const vue2CdnUrl = /* @__PURE__ */ getUrl('vue@2');\r\n\r\nexport const vueSfcLoaderCdnBaseUrl = /* @__PURE__ */ getUrl('vue3-sfc-loader@0.8.4/dist/');\r\n\r\nexport const wabtjsUrl = /* @__PURE__ */ getUrl('wabt@1.0.32/index.js');\r\n\r\nexport const waveDromBaseUrl = /* @__PURE__ */ getUrl('wavedrom@3.2.0/');\r\n\r\nexport const webRBaseUrl = /* @__PURE__ */ getUrl('@r-wasm/webr@0.1.1/dist/');\r\n","/* eslint-disable import/no-internal-modules */\r\n// @ts-ignore\r\n// eslint-disable-next-line import/no-unresolved\r\nimport appHTML from './html/app.html?raw';\r\nimport { customEvents } from './events/custom-events';\r\nimport type { API, CDN, Config, EmbedOptions } from './models';\r\nimport { isInIframe } from './utils/utils';\r\nimport { esModuleShimsPath } from './vendors';\r\nimport { modulesService } from './services/modules';\r\n\r\nexport type { API, Config };\r\n\r\nexport const params = new URLSearchParams(location.search);\r\nexport const isLite = params.get('lite') != null && params.get('lite') !== 'false';\r\nexport const isEmbed =\r\n  isLite || (params.get('embed') != null && params.get('embed') !== 'false') || isInIframe();\r\nexport const loadingParam = params.get('loading');\r\nexport const clickToLoad = isEmbed && loadingParam !== 'eager';\r\nexport const loading: EmbedOptions['loading'] = !isEmbed\r\n  ? 'eager'\r\n  : loadingParam === 'lazy' || loadingParam === 'click' || loadingParam === 'eager'\r\n  ? loadingParam\r\n  : 'lazy';\r\n\r\nexport const livecodes = async (container: string, config: Partial<Config> = {}): Promise<API> =>\r\n  new Promise(async (resolve) => {\r\n    const containerElement = document.querySelector(container);\r\n    if (!containerElement) {\r\n      throw new Error(`Cannot find element with the selector: \"${container}\"`);\r\n    }\r\n    const baseUrl =\r\n      (location.origin + location.pathname).split('/').slice(0, -1).join('/') + '/livecodes/';\r\n    const scriptFile = isLite\r\n      ? '{{hash:lite.js}}'\r\n      : isEmbed\r\n      ? '{{hash:embed.js}}'\r\n      : '{{hash:app.js}}';\r\n    const anyOrigin = '*';\r\n\r\n    const style = document.createElement('style');\r\n    style.innerHTML = `\r\n        ${container} {\r\n            min-width: 300px;\r\n            min-height: 200px;\r\n            padding: 0;\r\n            overflow: hidden;\r\n        }\r\n        ${container} > iframe {\r\n            border: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n        }\r\n        ${container}.embed iframe {\r\n            width: calc(100% - 2px);\r\n            height: calc(100% - 2px);\r\n            border: 1px solid #001b25;\r\n            border-radius: 5px;\r\n        }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    const appCDN = await modulesService.checkCDNs(esModuleShimsPath, params.get('appCDN') as CDN);\r\n\r\n    const loadApp = () => {\r\n      const supportsImportMaps = HTMLScriptElement.supports\r\n        ? HTMLScriptElement.supports('importmap')\r\n        : false;\r\n\r\n      const iframe = document.createElement('iframe');\r\n      iframe.name = 'app';\r\n      iframe.style.display = 'none';\r\n\r\n      containerElement.appendChild(iframe);\r\n      iframe.contentWindow?.document.open();\r\n      iframe.contentWindow?.document.write(\r\n        appHTML\r\n          .replace(/{{baseUrl}}/g, baseUrl)\r\n          .replace(/{{script}}/g, scriptFile)\r\n          .replace(/{{appCDN}}/g, appCDN)\r\n          .replace(/{{esModuleShimsUrl}}/g, modulesService.getUrl(esModuleShimsPath, appCDN as CDN))\r\n          .replace(\r\n            /{{codemirrorModule}}/g,\r\n            supportsImportMaps\r\n              ? ''\r\n              : `\r\n          <script type=\"module\">\r\n            import * as mod from '${baseUrl}{{hash:codemirror.js}}';\r\n            window['${baseUrl}{{hash:codemirror.js}}'] = mod;\r\n          </script>\r\n          `,\r\n          )\r\n          .replace(\r\n            /{{codemirrorCoreUrl}}/g,\r\n            `${baseUrl}vendor/codemirror/${process.env.codemirrorVersion}/codemirror-core.js`,\r\n          ),\r\n      );\r\n      iframe.contentWindow?.document.close();\r\n\r\n      if (isEmbed) {\r\n        window.addEventListener(customEvents.appLoaded, () => {\r\n          parent.postMessage({ type: customEvents.appLoaded }, anyOrigin);\r\n        });\r\n\r\n        window.addEventListener(customEvents.ready, () => {\r\n          parent.postMessage({ type: customEvents.ready }, anyOrigin);\r\n        });\r\n\r\n        window.addEventListener(customEvents.change, () => {\r\n          parent.postMessage({ type: customEvents.change }, anyOrigin);\r\n        });\r\n      }\r\n\r\n      iframe.addEventListener('load', async () => {\r\n        const app = (iframe.contentWindow as any)?.app;\r\n        if (typeof app === 'function') {\r\n          const api: API = await app(config, baseUrl);\r\n          iframe.style.display = 'block';\r\n          window.dispatchEvent(\r\n            new CustomEvent(customEvents.appLoaded, {\r\n              detail: api,\r\n            }),\r\n          );\r\n\r\n          addEventListener(\r\n            'message',\r\n            async (e: MessageEventInit<{ method: keyof API; args: any }>) => {\r\n              if (isEmbed) {\r\n                if (e.source !== parent) return;\r\n                const { method, args } = e.data || {};\r\n                if (!method) return;\r\n                const methodArguments = Array.isArray(args) ? args : [args];\r\n                let payload;\r\n                try {\r\n                  payload = await (api[method] as any)(...methodArguments);\r\n                } catch (error: any) {\r\n                  payload = { error: error.message || error };\r\n                }\r\n                parent.postMessage(\r\n                  {\r\n                    type: customEvents.apiResponse,\r\n                    method,\r\n                    payload,\r\n                  },\r\n                  anyOrigin,\r\n                );\r\n              } else {\r\n                if (e.source !== iframe.contentWindow) return;\r\n                if (e.data?.args === 'home') {\r\n                  location.href = '/';\r\n                }\r\n              }\r\n            },\r\n          );\r\n\r\n          resolve(api);\r\n        }\r\n      });\r\n    };\r\n\r\n    if (clickToLoad) {\r\n      window.addEventListener(customEvents.load, loadApp, { once: true });\r\n\r\n      const preloadLink = document.createElement('link');\r\n      preloadLink.href = baseUrl + scriptFile;\r\n      preloadLink.rel = 'preload';\r\n      preloadLink.as = 'script';\r\n      document.head.appendChild(preloadLink);\r\n    } else {\r\n      loadApp();\r\n    }\r\n  });\r\n","/* eslint-disable import/no-internal-modules */\r\nimport type { Config, CustomEvents } from './livecodes/models';\r\nimport { shareService } from './livecodes/services/share';\r\nimport { livecodes, params, isEmbed, loadingParam, clickToLoad, loading } from './livecodes/main';\r\nimport { customEvents } from './livecodes/events/custom-events';\r\n\r\nconst loadPreview = async (id: string) => {\r\n  if (!id) return;\r\n  const content = await shareService.getProject(id);\r\n  if (!content.result) return;\r\n\r\n  const previewFrame = document.createElement('iframe');\r\n  previewFrame.setAttribute(\r\n    'sandbox',\r\n    'allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts',\r\n  );\r\n  previewFrame.setAttribute('scrolling', 'no');\r\n  previewFrame.classList.add('preview');\r\n  previewFrame.srcdoc = content.result;\r\n  document.body.appendChild(previewFrame);\r\n};\r\n\r\nif (loadingParam === 'click' && ['true', '', '1'].includes(params.get('preview') as string)) {\r\n  const id = params.get('x');\r\n  if (id?.startsWith('id/')) {\r\n    loadPreview(id.replace('id/', ''));\r\n  }\r\n}\r\n\r\nconst animatingLogo = document.querySelector<HTMLElement>('#animating-logo')!;\r\nconst cube = document.querySelector<HTMLElement>('#cube')!;\r\nconst clickToLoadEl = document.querySelector<HTMLElement>('#click-to-load')!;\r\n\r\nif (isEmbed) {\r\n  document.body.classList.add('embed');\r\n  if (clickToLoad) {\r\n    document.body.classList.add('click-to-load');\r\n    cube.classList.remove('cube');\r\n    animatingLogo.classList.add('hidden');\r\n    animatingLogo.style.display = 'none';\r\n    clickToLoadEl.style.display = 'flex';\r\n    clickToLoadEl.classList.add('visible');\r\n\r\n    // load on click\r\n    clickToLoadEl.addEventListener('click', load);\r\n\r\n    // load from API\r\n    addEventListener('message', (e) => {\r\n      if (e.source === parent && e.data?.type === customEvents.load) {\r\n        load();\r\n      }\r\n    });\r\n\r\n    // load on visible\r\n    if (loading === 'lazy' && 'IntersectionObserver' in window) {\r\n      const observer = new IntersectionObserver(\r\n        (entries, observer) => {\r\n          entries.forEach(async (entry) => {\r\n            if (entry.isIntersecting) {\r\n              load();\r\n              observer.unobserve(document.body);\r\n            }\r\n          });\r\n        },\r\n        { rootMargin: '150px' },\r\n      );\r\n      observer.observe(document.body);\r\n    }\r\n  }\r\n}\r\n\r\nfunction load() {\r\n  clickToLoadEl.classList.remove('visible');\r\n  document.querySelector('.preview')?.classList.add('hidden');\r\n  setTimeout(() => {\r\n    document.body.classList.remove('click-to-load');\r\n    animatingLogo.style.display = 'flex';\r\n    animatingLogo.classList.remove('hidden');\r\n    cube.classList.add('cube');\r\n    setTimeout(() => {\r\n      clickToLoadEl.remove();\r\n      document.querySelector('.preview')?.remove();\r\n    }, 300);\r\n  }, 500);\r\n  window.dispatchEvent(new Event(customEvents.load));\r\n}\r\n\r\nfunction resize() {\r\n  document.body.style.height = window.innerHeight + 'px';\r\n}\r\n\r\nresize();\r\nwindow.addEventListener('resize', resize, false);\r\nsetTimeout(resize, 500);\r\n\r\nwindow.addEventListener(customEvents.appLoaded, (e: CustomEventInit) => {\r\n  animatingLogo.remove();\r\n  (window as any).livecodes = e.detail;\r\n});\r\n\r\nwindow.addEventListener(customEvents.ready, () => {\r\n  // project loaded\r\n});\r\n\r\nwindow.addEventListener(customEvents.change, () => {\r\n  // content change\r\n});\r\n\r\nwindow.addEventListener(customEvents.testResults, (_e: CustomEventInit) => {\r\n  // const testResults = e.detail;\r\n});\r\n\r\nwindow.addEventListener(customEvents.destroy, () => {\r\n  window.removeEventListener('resize', resize);\r\n  document.body.innerHTML = '';\r\n  document.head.innerHTML = '';\r\n});\r\n\r\nif (isEmbed && params.get('config') === 'sdk') {\r\n  addEventListener(\r\n    'message',\r\n    function configHandler(\r\n      e: MessageEventInit<{ type: CustomEvents['config']; payload: Partial<Config> }>,\r\n    ) {\r\n      if (e.source !== parent || e.data?.type !== customEvents.config) return;\r\n      removeEventListener('message', configHandler);\r\n      livecodes('#livecodes', e.data.payload);\r\n    },\r\n  );\r\n  parent.postMessage({ type: customEvents.getConfig }, '*');\r\n} else {\r\n  livecodes('#livecodes');\r\n}\r\n"],"names":["allowedOrigin","origin","dpasteGetUrl","dpastePostUrl","apiUrl","dpasteService","id","res","config","apiService","shareService","appHTML","customEvents","isInIframe","moduleCDNs","npmCDNs","ghCDNs","modulesService","moduleName","isModule","defaultCDN","moduleUrl","getCdnUrl","path","cdn","getAppCDN","testModule","preferredCDN","cdns","modName","post","i","TEMPLATES","pattern","template","esModuleShimsPath","params","isLite","isEmbed","loadingParam","clickToLoad","loading","livecodes","container","resolve","containerElement","baseUrl","scriptFile","anyOrigin","style","appCDN","loadApp","supportsImportMaps","iframe","_a","_b","_c","app","api","e","method","args","methodArguments","payload","error","preloadLink","loadPreview","content","previewFrame","animatingLogo","cube","clickToLoadEl","load","entries","observer","entry","resize","_e","configHandler"],"mappings":"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"}