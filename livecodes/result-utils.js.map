{
  "version": 3,
  "sources": ["../../src/livecodes/result/utils.ts", "../../src/livecodes/result/result-utils.ts"],
  "sourcesContent": ["// modified from https://github.com/alexindigo/precise-typeof/blob/master/index.js\r\nexport const typeOf = (obj: any) => {\r\n  function isElement(o: any) {\r\n    return typeof HTMLElement === 'object'\r\n      ? o instanceof HTMLElement\r\n      : o &&\r\n          typeof o === 'object' &&\r\n          o !== null &&\r\n          o.nodeType === 1 &&\r\n          typeof o.nodeName === 'string';\r\n  }\r\n  function isNode(o: any) {\r\n    return typeof Node === 'object'\r\n      ? o instanceof Node\r\n      : o &&\r\n          typeof o === 'object' &&\r\n          typeof o.nodeType === 'number' &&\r\n          typeof o.nodeName === 'string';\r\n  }\r\n  function isDocument(o: any) {\r\n    return Object.prototype.toString.call(o) === '[object HTMLDocument]';\r\n  }\r\n  function isWindow(o: any) {\r\n    return Object.prototype.toString.call(o) === '[object Window]';\r\n  }\r\n\r\n  const stamp: string = Object.prototype.toString.call(obj);\r\n\r\n  if (obj === undefined) return 'undefined';\r\n  if (obj === null) return 'null';\r\n\r\n  if (isWindow(obj)) return 'window';\r\n  if (isDocument(obj)) return 'document';\r\n  if (isElement(obj)) return 'element';\r\n  if (isNode(obj)) return 'node';\r\n\r\n  if (\r\n    obj.constructor &&\r\n    typeof obj.constructor.isBuffer === 'function' &&\r\n    obj.constructor.isBuffer(obj)\r\n  ) {\r\n    return 'buffer';\r\n  }\r\n\r\n  if (typeof window === 'object' && obj === window) return 'window';\r\n  if (typeof global === 'object' && obj === global) return 'global';\r\n\r\n  if (typeof obj === 'number' && isNaN(obj)) return 'nan';\r\n  if (typeof obj === 'object' && stamp === '[object Number]' && isNaN(obj)) return 'nan';\r\n\r\n  if (typeof obj === 'object' && stamp.substr(-6) === 'Event]') return 'event';\r\n  if (stamp.substr(0, 12) === '[object HTML') return 'element';\r\n  if (stamp.substr(0, 12) === '[object Node') return 'node';\r\n\r\n  // last resort\r\n  const type = stamp.match(/\\[object\\s*([^\\]]+)\\]/);\r\n  if (type) return type[1].toLowerCase();\r\n\r\n  return 'object';\r\n};\r\n\r\nfunction consoleArgs(args: any[]): Array<{ type: string; content: any }> {\r\n  return args.map((arg) => {\r\n    switch (typeOf(arg)) {\r\n      case 'window':\r\n      case 'function':\r\n      case 'date':\r\n      case 'symbol':\r\n        return { type: typeOf(arg), content: arg.toString() };\r\n      case 'document':\r\n        return { type: typeOf(arg), content: arg.documentElement.outerHTML };\r\n      case 'element':\r\n        return { type: typeOf(arg), content: arg.outerHTML };\r\n      case 'node':\r\n        return { type: typeOf(arg), content: arg.textContent };\r\n      case 'array':\r\n        return { type: typeOf(arg), content: arg.map((x: unknown) => consoleArgs([x])[0].content) };\r\n      case 'object':\r\n        return {\r\n          type: typeOf(arg),\r\n          content: Object.keys(arg).reduce(\r\n            (acc, key) => ({ ...acc, [key]: consoleArgs([arg[key]])[0].content }),\r\n            {},\r\n          ),\r\n        };\r\n      case 'error':\r\n        return {\r\n          type: typeOf(arg),\r\n          content: arg.constructor.name + ': ' + arg.message,\r\n        };\r\n    }\r\n    return { type: 'other', content: arg };\r\n  });\r\n}\r\n\r\nexport const proxyConsole = () => {\r\n  window.console = new Proxy(console, {\r\n    get(target, method) {\r\n      return function (...args: any[]) {\r\n        if (!(method in target)) {\r\n          const msg = `Uncaught TypeError: console.${String(method)} is not a function`;\r\n          target.error(msg);\r\n          parent.postMessage({ type: 'console', method: 'error', args: consoleArgs([msg]) }, '*');\r\n          return;\r\n        }\r\n        (target[method as keyof typeof console] as any)(...args);\r\n        parent.postMessage({ type: 'console', method, args: consoleArgs(args) }, '*');\r\n      };\r\n    },\r\n  });\r\n\r\n  window.addEventListener('error', (error) => {\r\n    parent.postMessage(\r\n      {\r\n        type: 'console',\r\n        method: 'error',\r\n        args: consoleArgs([error.message]),\r\n      },\r\n      '*',\r\n    );\r\n  });\r\n};\r\n\r\nexport const handleEval = () => {\r\n  window.addEventListener('message', (event) => {\r\n    if (event.data.console) {\r\n      const evalCode = () => {\r\n        try {\r\n          return {\r\n            type: 'console',\r\n            method: 'output',\r\n            // eslint-disable-next-line no-eval\r\n            args: consoleArgs([window.eval(event.data.console)]),\r\n          };\r\n        } catch (error) {\r\n          return { type: 'console', method: 'error', args: consoleArgs([error]) };\r\n        }\r\n      };\r\n      parent.postMessage(evalCode(), '*');\r\n    }\r\n  });\r\n};\r\n\r\nexport const handleResize = () => {\r\n  window.addEventListener('resize', () => {\r\n    parent.postMessage(\r\n      {\r\n        type: 'resize',\r\n        sizes: {\r\n          width: window.innerWidth,\r\n          height: window.innerHeight,\r\n        },\r\n      },\r\n      '*',\r\n    );\r\n  });\r\n};\r\n\r\nexport const handleScrollPosition = () => {\r\n  window.addEventListener('scroll', () => {\r\n    parent.postMessage(\r\n      {\r\n        type: 'scroll',\r\n        position: {\r\n          x: window.scrollX,\r\n          y: window.scrollY,\r\n        },\r\n      },\r\n      '*',\r\n    );\r\n  });\r\n  const prefix = '#livecodes-scroll-position:';\r\n  if (location.hash.startsWith(prefix)) {\r\n    const [x, y] = location.hash.replace(prefix, '').split(',').map(Number);\r\n    window.addEventListener('DOMContentLoaded', () => {\r\n      window.scrollTo({ top: y, left: x });\r\n    });\r\n  }\r\n};\r\n", "import { handleEval, handleResize, handleScrollPosition, proxyConsole } from './utils';\r\n\r\n(window as any).livecodes = (window as any).livecodes || {};\r\nproxyConsole();\r\nhandleEval();\r\nhandleResize();\r\nhandleScrollPosition();\r\n\r\nwindow.addEventListener('message', function (event) {\r\n  if (event.data.styles) {\r\n    const styles = document.querySelector('#__livecodes_styles__');\r\n    if (!styles) return;\r\n    styles.innerHTML = event.data.styles;\r\n  }\r\n  if (event.data.flush) {\r\n    document.body.innerHTML = '';\r\n    document.head.innerHTML = '';\r\n  } else {\r\n    parent.postMessage({ type: 'loading', payload: false }, '*');\r\n  }\r\n});\r\n\r\nwindow.addEventListener('load', () => {\r\n  parent.postMessage({ type: 'loading', payload: false }, '*');\r\n});\r\n"],
  "mappings": "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",
  "names": ["typeOf", "obj", "isElement", "o", "isNode", "isDocument", "isWindow", "stamp", "type", "consoleArgs", "args", "arg", "x", "acc", "key", "proxyConsole", "target", "method", "msg", "error", "handleEval", "event", "evalCode", "handleResize", "handleScrollPosition", "prefix", "y", "proxyConsole", "handleEval", "handleResize", "handleScrollPosition", "event", "styles"]
}
